{% extends "base.html" %}
{% load static %}
{% block content %}
	<h2 class="sub-title">Listado de alumnos de {{ grado }}</h2>
	<div id="suit-center">
		{% if not user.is_authenticated or not user.is_staff %}
			<div class="alert alert-block alert-error"><h4><a href="{% url 'index' %}" class="text-error">No deberías estar aquí...</a></h4></div>
		{% else %}
			<div id="menu">
				{% if l_grados|length > 1 %}
				<form enctype="multipart/form-data" method="post">
					{% csrf_token %}
					<select id="id_l_grado" name="l_grado" required="">
						{% for l_grado in l_grados %}
							<option value="{{ l_grado }}"{% if l_grado == grado %}selected="selected"{% endif %}>{{ l_grado }}</option>
						{% endfor %}
					</select>
					<button class="btn btn-high btn-info" type="submit">Mostrar listado</button>
				</form>
				{% endif %}
			</div>
			{% if alumnos|length %}
				<div class="results">
					<table id="result_list" class="table table-striped table-bordered table-hover table-alumnos">
						<tr>
							<th>Nombre de usuario</th>
							<th>Nombre</th>
							<th>Apellidos</th>
							<th>DNI</th>
							<th>Fecha de nacimiento</th>
							<th>Correo electrónico</th>
							<th>Telefono</th>
							<th colspan="3"></th>
						</tr>
						{% for alumno in alumnos %}
							<tr>
								<td class="alumno-data">{{ alumno.0.1.uid.0 }}</td>
								<td class="alumno-data">{{ alumno.0.1.givenName.0 }}</td>
								<td class="alumno-data">{{ alumno.0.1.sn.0 }}</td>
								<td class="alumno-data">{{ alumno.0.1.dni.0|slice:":8" }}-{{ alumno.0.1.dni.0|slice:"8:" }}</td>
								<td class="alumno-data">{{ alumno.0.1.fnac.0|slice:"6:8" }}/{{ alumno.0.1.fnac.0|slice:"4:6" }}/{{ alumno.0.1.fnac.0|slice:":4" }}</td>
								<td class="alumno-data">{{ alumno.0.1.mail.0 }}</td>
								<td class="alumno-data">{{ alumno.0.1.telephoneNumber.0 }}</td>
								<td class="alumno-button"><button class="btn btn-high" onclick="location.href='{% url 'perfil' grado alumno.0.1.uid.0 %}'">Ver detalle</button></td>
								<td class="alumno-button"><button class="btn btn-high" onclick="location.href='{% url 'respuestas' grado alumno.0.1.uid.0 %}'">Evaluación inicial</button></td>
								<td class="alumno-button"><button class="btn btn-high btn-info" onclick="location.href='{% url 'confirmar_baja' grado alumno.0.1.uid.0 %}'">Dar de baja</button></td>
							</tr>
						{% endfor %}
					</table>
				</div>
			{% else %}
				<div class="alert alert-warn">No existen alumnos activos para este curso de <strong>{{ grado }}</strong></div>
			{% endif %}
			<div><button class="btn btn-high" onclick="location.href='{% url 'index' %}'">Volver</button></div>
		{% endif %}
	</div>
{% endblock %}
